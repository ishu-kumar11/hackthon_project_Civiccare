{% extends "authority/base_authority.html" %}
{% load static %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'authority/css/issue_list.css' %}">
{% endblock %}

{% block authority_content %}

<h4 class="page-title">All Issues</h4>

<!-- Filters -->
<form method="get" class="filter-bar">
  <input type="text" name="q" placeholder="Search complaint / title">

  <select name="status">
    <option value="">All Status</option>
    <option value="pending">Pending</option>
    <option value="in_progress">In Progress</option>
    <option value="resolved">Resolved</option>
  </select>

  <select name="category">
    <option value="">All Categories</option>
    <option value="road">Road</option>
    <option value="water">Water</option>
    <option value="electricity">Electricity</option>
    <option value="garbage">Garbage</option>
  </select>

  <button type="submit" class="btn-filter">Filter</button>
</form>

<!-- Issues Table -->
<table class="issue-table">
  <thead>
    <tr>
      <th>ID</th>
      <th>Title</th>
      <th>State</th>
      <th>District</th>
      <th>Pincode</th>
      <th>Area</th>
      <th>Status</th>
      <th>Fake</th>
      <th>Actions</th>
    </tr>
  </thead>

  <tbody>
    {% for issue in issues %}
    <tr>
      <td>{{ issue.complaint_id }}</td>
      <td>{{ issue.title }}</td>
      <td>{{ issue.state }}</td>
      <td>{{ issue.district }}</td>
      <td>{{ issue.pincode }}</td>
      <td>{{ issue.location }}</td>
      <td>
        <span class="status-badge status-{{ issue.status|lower }}">
          {{ issue.status }}
        </span>
      </td>

      <td class="fake-col">
        {% if issue.is_fake %}
          ✖
        {% else %}
          —
        {% endif %}
      </td>

      <td class="action-col">
        <a href="{% url 'update_issue_status' issue.id %}" class="action-link">
          Update
        </a>

        {% if not issue.is_fake %}
          <a href="{% url 'mark_issue_fake' issue.id %}"
             class="action-link danger"
             onclick="return confirm('Mark this issue as fake?');">
            Mark Fake
          </a>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
